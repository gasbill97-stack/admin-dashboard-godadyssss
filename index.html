<!DOCTYPE html>
<html>
<head>
    <title>Admin Dashboard</title>
    <style>
        body {
            font-family: Arial;
            background: #f8f9fa;
            margin: 0;
            padding: 20px;
        }
        #loginScreen {
            background: white;
            padding: 40px;
            max-width: 400px;
            margin: 50px auto;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
        }
        #password {
            width: 100%;
            padding: 15px;
            margin: 15px 0;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            box-sizing: border-box;
        }
        #loginBtn {
            width: 100%;
            padding: 15px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 18px;
            cursor: pointer;
        }
        #dashboard {
            display: none;
        }
        .header {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .device {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #007bff;
        }
        .action-btn {
            padding: 8px 12px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        .btn-sms { background: #dbeafe; color: #1e40af; }
        .btn-call { background: #d1fae5; color: #065f46; }
        .btn-view { background: #fef3c7; color: #92400e; }
        .btn-forms { background: #f3e8ff; color: #5b21b6; }
        .btn-delete { background: #fee2e2; color: #991b1b; }
        .online { color: green; font-weight: bold; }
        .offline { color: red; font-weight: bold; }
    </style>
</head>
<body>

<!-- LOGIN -->
<div id="loginScreen">
    <h2>Admin Login</h2>
    <p>Enter password to access dashboard</p>
    <input type="password" id="password" placeholder="Password" value="admin123">
    <button id="loginBtn">LOGIN</button>
    <p style="color:#666; margin-top:15px;">Default password: <b>admin123</b></p>
</div>

<!-- DASHBOARD -->
<div id="dashboard">
    <div class="header">
        <div>
            <h2>Device Manager</h2>
            <p id="deviceCount">0 devices</p>
        </div>
        <button id="logoutBtn" class="action-btn" style="background:#6c757d; color:white;">Logout</button>
    </div>
    
    <div id="devices"></div>
</div>

<script>
// ================= VARIABLES =================
let devicesData = [];

// ================= INITIALIZE =================
window.onload = function() {
    console.log("Page loaded");
    
    // Set up event listeners
    document.getElementById('loginBtn').onclick = function() {
        login();
    };
    
    document.getElementById('logoutBtn').onclick = function() {
        logout();
    };
    
    // Enter key support
    document.getElementById('password').onkeypress = function(e) {
        if (e.key === 'Enter') {
            login();
        }
    };
    
    // Check if already logged in
    if (localStorage.getItem('loggedIn') === 'true') {
        showDashboard();
        loadDevices();
    }
};

// ================= LOGIN FUNCTION =================
function login() {
    console.log("Login function called");
    
    var pass = document.getElementById('password').value;
    console.log("Password entered: " + pass);
    
    if (pass === "admin123") {
        console.log("Login successful");
        
        // Save login state
        localStorage.setItem('loggedIn', 'true');
        
        // Show dashboard
        showDashboard();
        
        // Load devices
        loadDevices();
        
        // Show success
        alert("‚úÖ Login successful!");
        
    } else {
        console.log("Wrong password");
        alert("‚ùå Wrong password! Use: admin123");
        document.getElementById('password').style.borderColor = "red";
        setTimeout(function() {
            document.getElementById('password').style.borderColor = "#ddd";
        }, 1000);
    }
}

// ================= SHOW DASHBOARD =================
function showDashboard() {
    document.getElementById('loginScreen').style.display = 'none';
    document.getElementById('dashboard').style.display = 'block';
}

// ================= LOAD DEVICES =================
function loadDevices() {
    console.log("Loading devices");
    
    // Test devices
    devicesData = [
        {
            id: 1,
            name: "Samsung Phone",
            sim1: "+91 98765 43210",
            sim2: "Not available",
            battery: 85,
            online: true,
            model: "Galaxy S21"
        },
        {
            id: 2,
            name: "OnePlus Device",
            sim1: "+91 98765 43211",
            sim2: "+91 98765 43212",
            battery: 45,
            online: false,
            model: "OnePlus 9R"
        },
        {
            id: 3,
            name: "iPhone",
            sim1: "+91 98765 43213",
            sim2: "+91 98765 43214",
            battery: 92,
            online: true,
            model: "iPhone 13"
        }
    ];
    
    // Update count
    document.getElementById('deviceCount').innerHTML = devicesData.length + " devices connected";
    
    // Display devices
    displayDevices();
}

// ================= DISPLAY DEVICES =================
function displayDevices() {
    var container = document.getElementById('devices');
    var html = '';
    
    devicesData.forEach(function(device) {
        var status = device.online ? 'online' : 'offline';
        var statusText = device.online ? 'üü¢ Online' : 'üî¥ Offline';
        
        html += '<div class="device">';
        html += '<div style="display:flex; justify-content:space-between;">';
        html += '<div>';
        html += '<h3>' + device.name + '</h3>';
        html += '<p><span class="' + status + '">' + statusText + '</span> | üîã ' + device.battery + '%</p>';
        html += '</div>';
        html += '<button class="action-btn btn-delete" onclick="deleteDevice(' + device.id + ')">Delete</button>';
        html += '</div>';
        
        html += '<p><b>Model:</b> ' + device.model + '</p>';
        html += '<p><b>SIM 1:</b> ' + device.sim1 + '</p>';
        html += '<p><b>SIM 2:</b> ' + device.sim2 + '</p>';
        
        html += '<div style="margin-top:10px;">';
        html += '<button class="action-btn btn-sms" onclick="sendSMS(' + device.id + ')">SMS</button>';
        html += '<button class="action-btn btn-call" onclick="callForward(' + device.id + ')">Call</button>';
        html += '<button class="action-btn btn-view" onclick="viewSMS(' + device.id + ')">View SMS</button>';
        html += '<button class="action-btn btn-forms" onclick="viewForms(' + device.id + ')">Forms</button>';
        html += '</div>';
        
        html += '</div>';
    });
    
    container.innerHTML = html;
}

// ================= ACTION FUNCTIONS =================
function sendSMS(deviceId) {
    var device = devicesData.find(function(d) { return d.id === deviceId; });
    if (device) {
        var number = prompt("Enter phone number for " + device.name + ":");
        var message = prompt("Enter message:");
        if (number && message) {
            alert("SMS sent to " + number);
        }
    }
}

function callForward(deviceId) {
    var choice = prompt("1. Activate\n2. Deactivate\n3. Check Status\n\nEnter choice (1/2/3):");
    if (choice === "1") {
        var number = prompt("Enter forwarding number:");
        alert("Call forwarding activated to " + number);
    } else if (choice === "2") {
        alert("Call forwarding deactivated");
    } else if (choice === "3") {
        alert("Status: Active");
    }
}

function viewSMS(deviceId) {
    alert("Loading SMS history...");
}

function viewForms(deviceId) {
    alert("Loading form responses...");
}

function deleteDevice(deviceId) {
    if (confirm("Delete this device?")) {
        devicesData = devicesData.filter(function(d) { return d.id !== deviceId; });
        displayDevices();
        document.getElementById('deviceCount').innerHTML = devicesData.length + " devices connected";
        alert("Device deleted");
    }
}

function logout() {
    localStorage.removeItem('loggedIn');
    document.getElementById('dashboard').style.display = 'none';
    document.getElementById('loginScreen').style.display = 'block';
    document.getElementById('password').value = 'admin123';
    alert("Logged out");
}

// Make sure all functions are available globally
window.login = login;
window.logout = logout;
window.sendSMS = sendSMS;
window.callForward = callForward;
window.viewSMS = viewSMS;
window.viewForms = viewForms;
window.deleteDevice = deleteDevice;
</script>

</body>
</html>
